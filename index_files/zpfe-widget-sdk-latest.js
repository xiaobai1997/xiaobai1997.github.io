/*!
* @zpfe/widget-sdk-web@1.0.0
* (c) 2018-2019 zhaopin.com
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).zpWidget=t()}(this,function(){"use strict";var e;var i=new(function(e){var r=Object.prototype.hasOwnProperty,v="~";function n(){}function c(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,n,r,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new c(n,r||e,o),i=v?v+t:t;return e._events[i]?e._events[i].fn?e._events[i]=[e._events[i],s]:e._events[i].push(s):(e._events[i]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function t(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(v=!1)),t.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(v?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},t.prototype.listeners=function(e){var t=this._events[v?v+e:e];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,r=t.length,o=Array(r);n<r;n++)o[n]=t[n].fn;return o},t.prototype.listenerCount=function(e){var t=this._events[v?v+e:e];return t?t.fn?1:t.length:0},t.prototype.emit=function(e,t,n,r,o,s){var i=v?v+e:e;if(!this._events[i])return!1;var c,f,a=this._events[i],u=arguments.length;if(a.fn){switch(a.once&&this.removeListener(e,a.fn,void 0,!0),u){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,t),!0;case 3:return a.fn.call(a.context,t,n),!0;case 4:return a.fn.call(a.context,t,n,r),!0;case 5:return a.fn.call(a.context,t,n,r,o),!0;case 6:return a.fn.call(a.context,t,n,r,o,s),!0}for(c=Array(u-(f=1));f<u;f++)c[f-1]=arguments[f];a.fn.apply(a.context,c)}else{var p,l=a.length;for(f=0;f<l;f++)switch(a[f].once&&this.removeListener(e,a[f].fn,void 0,!0),u){case 1:a[f].fn.call(a[f].context);break;case 2:a[f].fn.call(a[f].context,t);break;case 3:a[f].fn.call(a[f].context,t,n);break;case 4:a[f].fn.call(a[f].context,t,n,r);break;default:if(!c)for(c=Array(u-(p=1));p<u;p++)c[p-1]=arguments[p];a[f].fn.apply(a[f].context,c)}}return!0},t.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},t.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},t.prototype.removeListener=function(e,t,n,r){var o=v?v+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||r&&!s.once||n&&s.context!==n||a(this,o);else{for(var i=0,c=[],f=s.length;i<f;i++)(s[i].fn!==t||r&&!s[i].once||n&&s[i].context!==n)&&c.push(s[i]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},t.prototype.removeAllListeners=function(e){var t;return e?this._events[t=v?v+e:e]&&a(this,t):(this._events=new n,this._eventsCount=0),this},t.prototype.off=t.prototype.removeListener,t.prototype.addListener=t.prototype.on,t.prefixed=v,e.exports=t.EventEmitter=t}(e={exports:{}},e.exports),e.exports),n={onmessage:function(e,t,n){i.on(e.widgetName+"-"+e.eventName,t,n)},postMessage:function(e){for(var t=e.widgetName,n=e.eventName,r=arguments.length,o=Array(1<r?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];i.emit.apply(i,[t+"-"+n].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(o)))}},r={},o={};return(Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e})({},{register:function(e,t){if("function"!=typeof t)throw Error("[Widget error]: Widget '"+e+"' should be Class.");r[e]=t,n.postMessage({widgetName:e,eventName:"ready"})},init:function(e,t){r[e]?o[e]=new r[e](t):n.onmessage({widgetName:e,eventName:"ready"},function(){o[e]=new r[e](t)})}},n)});
